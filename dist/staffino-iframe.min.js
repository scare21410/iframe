/*
 * (C) Copyright 2015 Staffino, s.r.o. (https://staffino.com/) and others.
 *
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */
!function(e){var t=[],o=[],i=[];e.fn.staffino=function(r){var n=e.extend({width:"100%",height:"content",scrollOnPopup:!0,baseUrl:"https://staffino.com"},r);if(!n.venue)throw new Error("Please specify venue ID");var s=n.baseUrl+"/"+(r.locale?r.locale+"/":"")+n.venue+"?customized=1"+location.hash,a=[];this.each(function(){iframe=e("<iframe></iframe>").attr({src:s,frameborder:0,scrolling:"no"}).get(0),a.push(iframe),e(this).append(iframe)}),"content"==n.width?Array.prototype.push.apply(t,a):e(a).map(function(){e(this).css("width",e.isNumeric(n.width)?n.width+"px":n.width)}),"content"==n.height?Array.prototype.push.apply(o,a):e(a).map(function(){e(this).css("width",e.isNumeric(n.height)?n.height+"px":n.height)}),n.scrollOnPopup&&Array.prototype.push.apply(i,a)},e(window).on("message",function(r){var n=r.originalEvent,s=n.data;if(s&&s.staffino)switch(s.staffino.message){case"url":n.source.postMessage({staffino:{url:{response:location.href}}},n.origin);break;case"resize":for(var a=0;a<t.length;a++)if(t[a].contentWindow===n.source){e(t[a]).css("height",s.staffino.width+"px");break}for(a=0;a<o.length;a++)if(o[a].contentWindow===n.source){e(o[a]).css("height",s.staffino.height+"px");break}break;case"scroll-to-iframe":for(a=0;a<i.length;a++)if(i[a].contentWindow===n.source){e("html, body").animate({scrollTop:e(i[a]).offset().top},500);break}}})}(jQuery);
